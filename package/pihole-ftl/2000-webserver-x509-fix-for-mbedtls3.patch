--- a/src/webserver/x509.c	2026-02-25 11:11:04.948672449 +0100
+++ b/src/webserver/x509.c	2026-02-20 09:07:54.210574880 +0100
@@ -229,7 +229,7 @@
 	mbedtls_x509write_crt_set_basic_constraints(&ca_cert, 1, -1);
 
 	// Export CA in PEM format
-	if((ret = mbedtls_x509write_crt_pem(&ca_cert, ca_buffer, sizeof(ca_buffer))) != 0)
+	if((ret = mbedtls_x509write_crt_pem(&ca_cert, ca_buffer, sizeof(ca_buffer), NULL, NULL)) != 0)
 	{
 		printf("ERROR: mbedtls_x509write_crt_pem (CA) returned %d\n", ret);
 		return false;
@@ -291,7 +291,7 @@
 		printf("mbedtls_x509write_crt_set_subject_alternative_name returned %d\n", ret);
 
 	// Export certificate in PEM format
-	if((ret = mbedtls_x509write_crt_pem(&server_cert, cert_buffer, sizeof(cert_buffer))) != 0)
+	if((ret = mbedtls_x509write_crt_pem(&server_cert, cert_buffer, sizeof(cert_buffer), NULL, NULL)) != 0)
 	{
 		printf("ERROR: mbedtls_x509write_crt_pem returned %d\n", ret);
 		return false;
@@ -442,7 +442,7 @@
 	mbedtls_pk_context key;
 	mbedtls_pk_init(&key);
 	bool has_key = true;
-	int rc = mbedtls_pk_parse_keyfile(&key, certfile, NULL);
+	int rc = mbedtls_pk_parse_keyfile(&key, certfile, NULL, NULL, NULL);
 	if (rc != 0)
 	{
 		log_info("No key found");
